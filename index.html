<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Webverse: Card Game</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- ë± ë¹Œë” í™”ë©´ -->
<div id="deck-builder-screen">
    <div class="builder-header">
        <h2>Deck Builder</h2>
        <div class="deck-counter-badge" id="deck-count-display">0 / 40</div>
    </div>
    <div class="builder-body">
        <div class="card-pool" id="builder-pool"></div>
        <div class="my-deck-panel">
            <!-- ì „ì  í‘œì‹œ -->
            <div class="stats-display" id="stats-display"></div>

            <!-- ë± ê´€ë¦¬ -->
            <div class="deck-manager">
                <input type="text" id="deck-name-input" placeholder="ë± ì´ë¦„ ì…ë ¥...">
                <button class="deck-manager-btn save" onclick="handleSaveDeck()">ì €ì¥</button>
                <button class="deck-manager-btn load" onclick="toggleSavedDecksList()">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button class="deck-manager-btn reset" onclick="resetAllData()">ì´ˆê¸°í™”</button>
            </div>
            <div class="saved-decks-list" id="saved-decks-list" style="display:none;"></div>

            <!-- ë± ë¦¬ìŠ¤íŠ¸ -->
            <div class="deck-list-scroll" id="builder-list"></div>
        </div>
    </div>
    <div class="builder-footer">
        <button class="start-btn" id="btn-finish-deck" disabled onclick="toStartScreen()">ì™„ë£Œ</button>
    </div>
</div>

<!-- ê²Œì„ ì‹œì‘ ì„ íƒ í™”ë©´ -->
<div id="start-overlay">
    <h1 style="color:var(--accent-gold); font-size: 40px; margin-bottom: 40px;">Game Start</h1>
    <div style="display:flex; gap:30px;">
        <button class="choice-btn" style="background:linear-gradient(135deg, #2980b9, #2c3e50);" onclick="startGame(true)">
            ì„ ê³µ (First)
            <span style="font-size:14px; opacity:0.8;">EP 2 / ì§„í™” 5í„´~</span>
        </button>
        <button class="choice-btn" style="background:linear-gradient(135deg, #c0392b, #2c3e50);" onclick="startGame(false)">
            í›„ê³µ (Second)
            <span style="font-size:14px; opacity:0.8;">EP 3 / ì§„í™” 4í„´~</span>
        </button>
    </div>
</div>

<!-- ê²Œì„ ì¢…ë£Œ ëª¨ë‹¬ -->
<div class="modal-overlay" id="game-end-modal">
    <div class="modal-box">
        <div class="modal-title" id="modal-result-title">ê²°ê³¼</div>
        <div class="modal-stats" id="modal-stats-content"></div>
        <div class="modal-buttons">
            <button class="modal-btn primary" onclick="restartGame()">ë‹¤ì‹œ í”Œë ˆì´</button>
            <button class="modal-btn secondary" onclick="location.href='index.html'">ë± ë¹Œë”ë¡œ</button>
        </div>
    </div>
</div>

<!-- ê²Œì„ ë³´ë“œ -->
<div id="game-board">
    <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°”: ë°°í‹€ë¡œê·¸ + ë± ì¹´ìš´í„° -->
    <div class="sidebar-left">
        <div class="log-header">Battle Log</div>
        <div id="game-log"></div>
        <div class="deck-counter">
            <div class="deck-icon">ğŸƒ</div>
            <span id="deck-count">40</span>
        </div>
    </div>

    <!-- ì¤‘ì•™ ë©”ì¸ ì˜ì—­ -->
    <div class="main-play-area">
        <!-- ì  ë¦¬ë” -->
        <div class="leader-area enemy">
            <div class="leader-info">
                <div id="enemy-hero" class="hero-avatar enemy">
                    <div class="hp-display" id="e-hp">20</div>
                </div>
                <div class="ep-container" id="e-ep"></div>
            </div>
            <div class="enemy-hand-mini" id="enemy-hand"></div>
        </div>

        <!-- ë°°í‹€ í•„ë“œ -->
        <div class="battle-field">
            <div class="field-row enemy-field" id="enemy-field"></div>
            <div class="field-divider"></div>
            <div class="field-row player-field" id="player-field"></div>
        </div>

        <!-- í”Œë ˆì´ì–´ ë¦¬ë” -->
        <div class="leader-area player">
            <div class="leader-info">
                <div id="player-hero" class="hero-avatar player">
                    <div class="hp-display" id="p-hp">20</div>
                </div>
                <div class="ep-container" id="p-ep"></div>
            </div>
        </div>

        <!-- í”Œë ˆì´ì–´ ì†íŒ¨ -->
        <div class="hand-area" id="player-hand"></div>
    </div>

    <!-- ìš°ì¸¡ ì‚¬ì´ë“œë°”: í„´ì¢…ë£Œ + PP -->
    <div class="sidebar-right">
        <div class="pp-display">
            <div class="pp-label">PP</div>
            <div class="pp-value"><span id="mana-current">0</span></div>
            <div class="pp-max"><span id="mana-max">0</span></div>
        </div>
        <button id="btn-end" class="action-btn end-turn" onclick="endTurn()">í„´ ì¢…ë£Œ</button>
        <button id="btn-evolve" class="action-btn evolve" onclick="toggleEvolve()">ì§„í™”</button>
    </div>
</div>

<!-- JavaScript íŒŒì¼ ë¡œë“œ (ìˆœì„œ ì¤‘ìš”) -->
<script src="js/cards.js"></script>
<script src="js/storage.js"></script>
<script src="js/animations.js"></script>
<script src="js/game.js"></script>
<script src="js/ai.js"></script>
<script src="js/ui.js"></script>
<script src="js/deck-builder.js"></script>
<script>
    // ì•± ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
        initFieldDragEvents();

        // ë§ˆì§€ë§‰ ë± ë¶ˆëŸ¬ì˜¤ê¸° ì‹œë„, ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ë±
        if (!loadLastDeck()) {
            initBuilder();
        } else {
            renderBuilder();
        }

        // ì „ì  í‘œì‹œ ì—…ë°ì´íŠ¸
        updateStatsDisplay();
    });
</script>
</body>
</html>
